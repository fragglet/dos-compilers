///////////////////////////////////////////////////////////////////////////
// FILE: new/new.h (Dynamic memory support)
//
// =========================================================================
//
//                          Open Watcom Project
//
// Copyright (c) 2004-2023 The Open Watcom Contributors. All Rights Reserved.
// Portions Copyright (c) 1983-2002 Sybase, Inc. All Rights Reserved.
//
//    This file is automatically generated. Do not edit directly.
//
// =========================================================================
//
// Description: This header is part of the C++ standard library.
///////////////////////////////////////////////////////////////////////////
#ifndef _NEW_INCLUDED
#define _NEW_INCLUDED

#ifndef _ENABLE_AUTODEPEND
 #pragma read_only_file
#endif

#ifndef __cplusplus
 #error This header file requires C++
#endif

#ifndef __COMDEF_H_INCLUDED
 #include <_comdef.h>
#endif

#ifndef _CSTDDEF_INCLUDED
 #include <cstddef>
#endif

#ifndef _EXCEPTION_INCLUDED
 #include <exception>
#endif

#ifndef _PFV_DEFINED
#define _PFV_DEFINED
 #define _PFV_DEFINED_
 typedef void (*PFV)( void );
#endif
#ifndef _PFU_DEFINED
#define _PFU_DEFINED
 #define _PFU_DEFINED_
 typedef int (*PFU)( unsigned );
#endif
#ifndef _PNH_DEFINED
#define _PNH_DEFINED
 #define _PNH_DEFINED_
 typedef int (*_PNH)( unsigned );
#endif
#if defined(__SW_BR) || defined(_RTDLL)
 #ifndef _PPV_DEFINED
 #define _PPV_DEFINED
  #define _PPV_DEFINED_
  typedef void (*_PVV)( void *);
 #endif
 #ifndef _PUP_DEFINED
 #define _PUP_DEFINED
  #define _PUP_DEFINED_
  typedef void* (*_PUP)( std::size_t );
 #endif
#endif

extern void *operator new( std::size_t );
extern void *operator new( std::size_t, void * );
extern void *operator new []( std::size_t );
extern void *operator new []( std::size_t, void * );
extern void operator delete( void * );
extern void operator delete []( void * );
_WPRTLINK extern PFU _set_new_handler( PFU );
#if defined(__SW_BR) || defined(_RTDLL)
 _WPRTLINK extern _PUP _set_op_new( _PUP );
 _WPRTLINK extern _PUP _set_op_new_array( _PUP );
 _WPRTLINK extern _PVV _set_op_delete( _PVV );
 _WPRTLINK extern _PVV _set_op_delete_array( _PVV );
#endif

namespace std {

    typedef void (_WCCALLBACK *new_handler)();
    _WPRTLINK extern new_handler set_new_handler( new_handler );

} // namespace std

// NOTE: Open Watcom currently does not throw std::bad_alloc on
// allocation failures. This class is defined here to so that programs
// that reference it will at least compile. Consider this a first step
// in building an exception throwing implementation of operator new.

namespace std {

  class bad_alloc : public exception {
  public:
    bad_alloc( ) _WCTHROWS() :
      exception( "unable to allocate memory" ) { }

    bad_alloc( const bad_alloc & ) _WCTHROWS() { }

    bad_alloc & operator=( bad_alloc & ) _WCTHROWS()
        { return *this; }

    virtual ~bad_alloc( ) _WCTHROWS() { }
  };

} // namespace std

#endif
